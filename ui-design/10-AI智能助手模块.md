# 10 - AI智能助手模块

> 状态：📋 规划中  
> 优先级：P1（重要功能）

---

## 10.1 AI助手首页 (AI Assistant)

### 页面信息
- **页面路径**：`pages/ai/index`
- **入口**：首页快捷入口 / 发现页

### 页面布局

```
┌─────────────────────────────────────┐
│  ←      AI智能助手                  │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐    │
│  │      ┌─────────────┐        │    │
│  │      │     🤖     │        │    │
│  │      │   灵枢AI   │        │    │
│  │      └─────────────┘        │    │
│  │                             │    │
│  │   你好！我是灵枢AI助手       │    │
│  │   可以帮你快速预约座位       │    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─ 快捷指令 ─────────────────┐    │
│  │                             │    │
│  │ ┌───────────┐ ┌───────────┐│    │
│  │ │ 📅 帮我预约│ │ 🔍 推荐座位││    │
│  │ │ 今天下午  │ │           ││    │
│  │ └───────────┘ └───────────┘│    │
│  │                             │    │
│  │ ┌───────────┐ ┌───────────┐│    │
│  │ │ 📊 学习报告│ │ ❓ 使用帮助││    │
│  │ │           │ │           ││    │
│  │ └───────────┘ └───────────┘│    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─ 对话区域 ─────────────────┐    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🎤 │ 输入你想说的...    发送 │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 快捷指令

| 指令 | 图标 | 触发对话 |
|------|------|----------|
| 帮我预约今天下午 | 📅 | "帮我预约今天下午的座位" |
| 推荐座位 | 🔍 | "根据我的习惯推荐座位" |
| 学习报告 | 📊 | "查看我的学习报告" |
| 使用帮助 | ❓ | "你能帮我做什么？" |

---

## 10.2 对话交互界面

### 对话流程示例

```
┌─────────────────────────────────────┐
│  ←      AI智能助手                  │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🤖 你好！我是灵枢AI助手，    │    │
│  │    有什么可以帮你的吗？      │    │
│  └─────────────────────────────┘    │
│                                     │
│         ┌─────────────────────┐     │
│         │ 帮我预约今天下午的   │ 👤  │
│         │ 座位，要安静一点的   │     │
│         └─────────────────────┘     │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🤖 好的，我来帮你找找～     │    │
│  │                             │    │
│  │ 根据你的偏好，我推荐以下座位：│    │
│  │                             │    │
│  │ ┌─────────────────────────┐│    │
│  │ │ 📍 图书馆 2F 自习室201   ││    │
│  │ │ 🪑 17号座位 · 靠窗安静区 ││    │
│  │ │ ⏰ 14:00-18:00 可预约    ││    │
│  │ │ 🔌 有电源 🔇 安静区      ││    │
│  │ │                         ││    │
│  │ │ ┌─────────────────────┐ ││    │
│  │ │ │     立即预约         │ ││    │
│  │ │ └─────────────────────┘ ││    │
│  │ └─────────────────────────┘│    │
│  │                             │    │
│  │ ┌─────────────────────────┐│    │
│  │ │ 📍 图书馆 3F 自习室301   ││    │
│  │ │ 🪑 08号座位 · 角落位置   ││    │
│  │ │ ⏰ 14:00-18:00 可预约    ││    │
│  │ │ 🔌 有电源               ││    │
│  │ │                         ││    │
│  │ │ ┌─────────────────────┐ ││    │
│  │ │ │     立即预约         │ ││    │
│  │ │ └─────────────────────┘ ││    │
│  │ └─────────────────────────┘│    │
│  │                             │    │
│  │ 还有其他需求吗？            │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │ 🎤 │ 输入你想说的...    发送 │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 消息类型

| 类型 | 说明 | 样式 |
|------|------|------|
| 用户消息 | 用户发送的文字 | 右侧气泡，主色调背景 |
| AI回复 | AI返回的文字 | 左侧气泡，灰色背景 |
| 座位卡片 | 推荐的座位信息 | 卡片样式，可点击预约 |
| 加载状态 | AI思考中 | 三个点动画 |
| 错误提示 | 网络错误等 | 红色提示文字 |

---

## 10.3 语音交互

### 语音输入界面

```
┌─────────────────────────────────────┐
│                                     │
│                                     │
│                                     │
│                                     │
│            ┌─────────┐              │
│            │         │              │
│            │   🎤   │              │
│            │  录音中 │              │
│            │         │              │
│            └─────────┘              │
│                                     │
│         ~~~~ 声波动画 ~~~~          │
│                                     │
│           正在聆听...               │
│                                     │
│                                     │
│  ┌─────────────────────────────┐    │
│  │         松开发送              │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │         上滑取消              │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 语音交互流程

1. **长按录音**：长按麦克风按钮开始录音
2. **松开发送**：松开按钮发送语音
3. **上滑取消**：上滑取消本次录音
4. **语音转文字**：发送后自动转换为文字显示
5. **AI处理**：AI理解语音内容并回复

---

## 10.4 智能推荐逻辑

### 用户画像分析

```
┌─────────────────────────────────────┐
│  ←      我的偏好                    │
├─────────────────────────────────────┤
│                                     │
│  ┌─ AI已学习的偏好 ───────────┐    │
│  │                             │    │
│  │  📍 常去地点                │    │
│  │  • 图书馆 2F (使用率 60%)   │    │
│  │  • 图书馆 3F (使用率 30%)   │    │
│  │                             │    │
│  │  ⏰ 偏好时段                │    │
│  │  • 下午场 14:00-18:00       │    │
│  │  • 晚间场 19:00-21:00       │    │
│  │                             │    │
│  │  🪑 座位偏好                │    │
│  │  • 靠窗位置                 │    │
│  │  • 有电源插座               │    │
│  │  • 安静区域                 │    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─ 手动设置偏好 ─────────────┐    │
│  │                             │    │
│  │  优先教学楼         图书馆 >│    │
│  │  ─────────────────────────  │    │
│  │  优先楼层           2F    > │    │
│  │  ─────────────────────────  │    │
│  │  座位类型           靠窗  > │    │
│  │  ─────────────────────────  │    │
│  │  需要电源           是    > │    │
│  │  ─────────────────────────  │    │
│  │  安静区域           是    > │    │
│  │                             │    │
│  └─────────────────────────────┘    │
│                                     │
│  ┌─────────────────────────────┐    │
│  │         保存偏好              │    │
│  └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 推荐算法因素

| 因素 | 权重 | 说明 |
|------|------|------|
| 历史偏好 | 40% | 用户历史预约的座位特征 |
| 手动设置 | 30% | 用户手动设置的偏好 |
| 实时可用 | 20% | 当前座位可用状态 |
| 距离因素 | 10% | 与用户位置的距离 |

---

## 10.5 常见对话场景

### 场景1：预约座位

```
用户：帮我预约明天上午的座位
AI：好的，请问你有什么特殊要求吗？比如：
    • 需要靠窗位置吗？
    • 需要有电源插座吗？
    • 偏好哪个教学楼？

用户：要有电源的，图书馆
AI：明白了，我帮你找到以下座位：
    [座位推荐卡片]
    点击即可预约～
```

### 场景2：查询预约

```
用户：我今天有预约吗？
AI：你今天有1个预约：
    📍 图书馆 2F 自习室201
    🪑 17号座位
    ⏰ 14:00-18:00
    状态：待签到
    
    需要我帮你取消或修改吗？
```

### 场景3：学习建议

```
用户：我最近学习效率不高怎么办？
AI：根据你的学习数据分析：
    • 你最高效的时段是下午14:00-16:00
    • 建议选择安静区域的座位
    • 可以尝试番茄工作法，每25分钟休息5分钟
    
    要我帮你预约下午的座位吗？
```

### 场景4：使用帮助

```
用户：你能帮我做什么？
AI：我可以帮你：
    📅 预约座位 - 告诉我时间和偏好
    🔍 推荐座位 - 根据你的习惯推荐
    📊 查看报告 - 分析你的学习数据
    ❓ 回答问题 - 关于自习室的任何问题
    
    试着说"帮我预约今天下午的座位"吧！
```

---

## 10.6 接口依赖

| 接口名称 | 请求方式 | 接口路径 | 说明 |
|----------|----------|----------|------|
| 发送消息 | POST | `/api/v1/ai/chat` | 发送对话消息 |
| 语音转文字 | POST | `/api/v1/ai/speech-to-text` | 语音识别 |
| 获取推荐 | GET | `/api/v1/ai/recommend` | 获取座位推荐 |
| 用户偏好 | GET | `/api/v1/ai/preference` | 获取用户偏好 |
| 更新偏好 | PUT | `/api/v1/ai/preference` | 更新用户偏好 |
| 对话历史 | GET | `/api/v1/ai/history` | 获取对话历史 |

---

## 10.7 技术实现要点

### RAG技术应用

1. **知识库构建**：
   - 自习室信息（位置、设施、开放时间）
   - 预约规则（时段、限制、积分规则）
   - 常见问题FAQ

2. **检索增强**：
   - 用户问题 → 向量化 → 检索相关知识
   - 结合用户上下文生成回答

3. **个性化推荐**：
   - 用户历史行为分析
   - 实时座位状态查询
   - 综合评分排序

---

> 上一篇：[09-学习成就模块](./09-学习成就模块.md)  
> 下一篇：[11-失物招领模块](./11-失物招领模块.md)
