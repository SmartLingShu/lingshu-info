# 06 - 数据统计模块

> 状态：📋 规划中  
> 优先级：P1（重要功能）

---

## 6.1 使用率统计 (Usage Statistics)

### 页面信息

- **页面路径**：`/study/statistics/usage`
- **页面类型**：数据可视化页
- **访问权限**：数据统计权限

### 页面布局

```text
┌─────────────────────────────────────────────────────────────┐
│  数据统计 / 使用率统计                                       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─ 筛选条件 ─────────────────────────────────────────────┐ │
│  │ 统计周期：┌──────────┐  教学楼：┌──────────┐           │ │
│  │          │ 本周  ▼ │         │ 全部  ▼ │           │ │
│  │          └──────────┘         └──────────┘           │ │
│  │                                                       │ │
│  │ 日期范围：┌──────────────────────────────┐  [查询]   │ │
│  │          │ 2024-12-01 至 2024-12-07     │           │ │
│  │          └──────────────────────────────┘           │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 核心指标 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐   │ │
│  │  │  1,256  │  │  78.5%  │  │  92.3%  │  │  3.2h   │   │ │
│  │  │ 预约总数 │  │ 座位使用率│  │ 履约率   │  │ 平均时长 │   │ │
│  │  │ ↑12.3% │  │ ↑5.2%  │  │ ↓1.1%  │  │ ↑0.3h  │   │ │
│  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘   │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 使用率趋势 ───────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  100% ┤                                                 │ │
│  │   80% ┤     ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   │ │
│  │   60% ┤  ▄▄▄████████████████████████████████████████   │ │
│  │   40% ┤▄▄████████████████████████████████████████████   │ │
│  │   20% ┤██████████████████████████████████████████████   │ │
│  │    0% ┼──────────────────────────────────────────────   │ │
│  │       周一  周二  周三  周四  周五  周六  周日            │ │
│  │                                                         │ │
│  │       ■ 座位使用率  ■ 预约率                            │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 时段分布 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  08:00 ████████████████████████████████████░░░░ 85%    │ │
│  │  10:00 ██████████████████████████████████████░░ 92%    │ │
│  │  14:00 ████████████████████████████████████████ 98%    │ │
│  │  16:00 ██████████████████████████████████████░░ 95%    │ │
│  │  19:00 ████████████████████████████████████████ 99%    │ │
│  │  21:00 ████████████████████████████████░░░░░░░░ 78%    │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 教室使用排行 ─────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  排名 │ 教室名称              │ 使用率 │ 预约次数 │ 趋势 │ │
│  │ ──────┼───────────────────────┼────────┼──────────┼──────│ │
│  │  1    │ 图书馆 2F 自习室201   │ 98.5%  │ 156      │ ↑    │ │
│  │  2    │ 图书馆 3F 自习室301   │ 95.2%  │ 142      │ ↑    │ │
│  │  3    │ 教学楼A 5F 自习室502  │ 92.8%  │ 128      │ →    │ │
│  │  4    │ 图书馆 2F 自习室202   │ 88.6%  │ 115      │ ↓    │ │
│  │  5    │ 教学楼B 3F 自习室301  │ 85.3%  │ 98       │ ↑    │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 核心指标说明

| 指标 | 计算方式 | 说明 |
| ---- | -------- | ---- |
| 预约总数 | 统计周期内预约记录数 | 包含所有状态的预约 |
| 座位使用率 | 已使用座位时长/总可用座位时长 | 反映座位资源利用效率 |
| 履约率 | 已完成预约数/总预约数 | 反映用户履约情况 |
| 平均时长 | 总学习时长/完成预约数 | 反映用户平均学习时长 |

### 筛选条件

| 字段 | 类型 | 选项 |
| ---- | ---- | ---- |
| 统计周期 | 下拉选择 | 今日、本周、本月、自定义 |
| 教学楼 | 下拉选择 | 全部、各教学楼 |
| 日期范围 | 日期范围选择器 | 选择自定义时显示 |

---

## 6.2 学习时长统计 (Study Duration Statistics)

### 页面信息

- **页面路径**：`/study/statistics/duration`
- **页面类型**：数据可视化页
- **访问权限**：数据统计权限

### 页面布局

```text
┌─────────────────────────────────────────────────────────────┐
│  数据统计 / 学习时长统计                                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─ 筛选条件 ─────────────────────────────────────────────┐ │
│  │ 统计周期：┌──────────┐  用户筛选：┌──────────────────┐ │ │
│  │          │ 本月  ▼ │           │ 请输入用户昵称   │ │ │
│  │          └──────────┘           └──────────────────┘ │ │
│  │                                                       │ │
│  │ 日期范围：┌──────────────────────────────┐  [查询]   │ │
│  │          │ 2024-12-01 至 2024-12-31     │           │ │
│  │          └──────────────────────────────┘           │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 时长概览 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐   │ │
│  │  │ 8,562h  │  │  2.8h   │  │  856    │  │  10.0h  │   │ │
│  │  │ 总学习时长│  │ 人均时长 │  │ 活跃用户 │  │ 最长时长 │   │ │
│  │  │ ↑15.6% │  │ ↑0.5h  │  │ ↑8.2%  │  │ 用户A   │   │ │
│  │  └─────────┘  └─────────┘  └─────────┘  └─────────┘   │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 时长趋势 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  500h ┤                                                 │ │
│  │  400h ┤        ▄▄▄▄                                     │ │
│  │  300h ┤     ▄▄▄████▄▄▄     ▄▄▄▄▄▄▄                     │ │
│  │  200h ┤  ▄▄▄██████████▄▄▄▄▄███████▄▄▄                  │ │
│  │  100h ┤▄▄████████████████████████████▄▄                │ │
│  │    0h ┼──────────────────────────────────────────────   │ │
│  │       1日  5日  10日  15日  20日  25日  30日            │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 时长分布 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │      ┌─────────────────────────────────┐               │ │
│  │      │           饼图                   │               │ │
│  │      │                                 │               │ │
│  │      │   0-1h: 15%    1-2h: 25%       │               │ │
│  │      │   2-3h: 30%    3-4h: 20%       │               │ │
│  │      │   4h以上: 10%                   │               │ │
│  │      │                                 │               │ │
│  │      └─────────────────────────────────┘               │ │
│  │                                                         │ │
│  │  用户学习时长分布（单次预约）                            │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 学习时长排行 ─────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  排名 │ 用户昵称 │ 学号        │ 总时长  │ 预约次数 │ 日均 │ │
│  │ ──────┼──────────┼─────────────┼─────────┼──────────┼──────│ │
│  │  🥇   │ 学霸小王 │ 2021****01  │ 68.5h   │ 28       │ 2.4h │ │
│  │  🥈   │ 努力小李 │ 2021****02  │ 62.0h   │ 25       │ 2.5h │ │
│  │  🥉   │ 勤奋小张 │ 2021****03  │ 58.5h   │ 24       │ 2.4h │ │
│  │  4    │ 用户D    │ 2022****04  │ 52.0h   │ 22       │ 2.4h │ │
│  │  5    │ 用户E    │ 2022****05  │ 48.5h   │ 20       │ 2.4h │ │
│  │                                                         │ │
│  │                              共 856 条  每页 20 条  1/43 │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 时长指标说明

| 指标 | 计算方式 | 说明 |
| ---- | -------- | ---- |
| 总学习时长 | 所有用户签到到签退的累计时长 | 统计周期内总时长 |
| 人均时长 | 总学习时长/活跃用户数 | 反映用户平均学习投入 |
| 活跃用户 | 有完成预约记录的用户数 | 统计周期内活跃用户 |
| 最长时长 | 单用户累计最长学习时长 | 显示对应用户 |

---

## 6.3 报表导出 (Report Export)

### 页面信息

- **页面路径**：`/study/statistics/export`
- **页面类型**：功能页
- **访问权限**：报表导出权限

### 页面布局

```text
┌─────────────────────────────────────────────────────────────┐
│  数据统计 / 报表导出                                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─ 导出配置 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  * 报表类型：                                           │ │
│  │    ○ 使用率统计报表                                     │ │
│  │    ○ 学习时长统计报表                                   │ │
│  │    ○ 预约记录明细                                       │ │
│  │    ○ 签到记录明细                                       │ │
│  │    ○ 违约记录明细                                       │ │
│  │    ○ 用户学习报告                                       │ │
│  │                                                         │ │
│  │  * 统计周期：                                           │ │
│  │    ┌──────────────────────────────────────────────┐    │ │
│  │    │ 2024-12-01 至 2024-12-31                     │    │ │
│  │    └──────────────────────────────────────────────┘    │ │
│  │                                                         │ │
│  │    教学楼筛选：                                         │ │
│  │    ┌──────────────────────────────────────────────┐    │ │
│  │    │ 全部                                      ▼ │    │ │
│  │    └──────────────────────────────────────────────┘    │ │
│  │                                                         │ │
│  │  * 导出格式：                                           │ │
│  │    ○ Excel (.xlsx)                                     │ │
│  │    ○ CSV (.csv)                                        │ │
│  │                                                         │ │
│  │  ┌─────────────────────────────────────────────────┐   │ │
│  │  │                    导出报表                       │   │ │
│  │  └─────────────────────────────────────────────────┘   │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌─ 导出历史 ─────────────────────────────────────────────┐ │
│  │                                                         │ │
│  │  文件名称                    │ 类型     │ 导出时间     │ 操作       │ │
│  │ ─────────────────────────────┼──────────┼──────────────┼────────────│ │
│  │  使用率统计_202412.xlsx      │ 使用率   │ 12-04 10:30  │ 下载  删除 │ │
│  │ ─────────────────────────────┼──────────┼──────────────┼────────────│ │
│  │  学习时长_202412.xlsx        │ 学习时长 │ 12-03 15:00  │ 下载  删除 │ │
│  │ ─────────────────────────────┼──────────┼──────────────┼────────────│ │
│  │  预约记录_202411.xlsx        │ 预约明细 │ 12-01 09:00  │ 下载  删除 │ │
│  │                                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 报表类型说明

| 报表类型 | 包含字段 | 说明 |
| -------- | -------- | ---- |
| 使用率统计报表 | 日期、教室、座位数、使用率、预约数 | 按教室汇总 |
| 学习时长统计报表 | 日期、总时长、人均时长、活跃用户数 | 按日期汇总 |
| 预约记录明细 | 预约ID、用户、教室、座位、时段、状态 | 明细数据 |
| 签到记录明细 | 签到ID、用户、教室、座位、签到时间、签退时间 | 明细数据 |
| 违约记录明细 | 违约ID、用户、违约类型、扣分、时间 | 明细数据 |
| 用户学习报告 | 用户、总时长、预约次数、履约率、信用分 | 按用户汇总 |

---

## 6.4 接口依赖

| 接口名称 | 请求方式 | 接口路径 | 说明 |
| -------- | -------- | -------- | ---- |
| 使用率统计 | GET | `/admin-api/study/statistics/usage` | 获取使用率统计数据 |
| 使用率趋势 | GET | `/admin-api/study/statistics/usage/trend` | 获取使用率趋势 |
| 时段分布 | GET | `/admin-api/study/statistics/usage/period` | 获取时段分布数据 |
| 教室排行 | GET | `/admin-api/study/statistics/classroom/rank` | 获取教室使用排行 |
| 学习时长统计 | GET | `/admin-api/study/statistics/duration` | 获取学习时长统计 |
| 时长趋势 | GET | `/admin-api/study/statistics/duration/trend` | 获取时长趋势 |
| 用户时长排行 | GET | `/admin-api/study/statistics/user/rank` | 获取用户时长排行 |
| 导出报表 | POST | `/admin-api/study/statistics/export` | 导出统计报表 |
| 导出历史 | GET | `/admin-api/study/statistics/export/history` | 获取导出历史 |
| 下载报表 | GET | `/admin-api/study/statistics/export/download` | 下载报表文件 |

---

> 上一篇：[05-公告管理模块](./05-公告管理模块.md)  
> 下一篇：[07-系统设置模块](./07-系统设置模块.md)
